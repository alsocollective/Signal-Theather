<html>
<head>
	<title>Signal</title>
</head>
	<style type="text/css">
	html,body{
		margin: 0px;
		padding: 0px;
		width: 100%;
		height: 100%;
		background-color: #fff;
	}

	#almightyParent{
		background-color: #ddd;
		position: absolute;
		width: -webkit-calc(100% - 5em);
		width: -moz-calc(100% - 5em);
		width: -o-calc(100% - 5em);
		width: calc(100% - 5em);

		height: -webkit-calc(100% - 5em);
		height: -moz-calc(100% - 5em);
		height: -o-calc(100% - 5em);
		height: calc(100% - 5em);
		left: 2.5em;
		top: 2.5em;

		overflow: hidden;

	}

	.navButton{
		position: absolute;
		width: 50px;
		height: 100%;
		background-color: #aaa;
		overflow: hidden;
	}

	#active #main{
		height: 100%;
	}

	</style>
<body>
	<div id="almightyParent">
		<div id="splash"></div>
		<div id="button1" class="navButton">
			<div class="content">
				<div id="active">
					<div id="main">
						<div id="archiveButton">to Archive</div>
					</div>
					<div id="navBar">
						<div id="activeButton">to Active</div>
					</div>
				</div>
				<div id="archive"></div>
			</div>
		</div>
		<div id="button2" class="navButton">
			<div class="content">
				<div id="active">
					<div id="main">
						<div id="archiveButton">to Archive</div>
					</div>
					<div id="navBar">
						<div id="activeButton">to Active</div>
					</div>
				</div>
				<div id="archive"></div>
			</div>
		</div>
		<div id="button3" class="navButton">
			<div class="content">
				<div id="active">
					<div id="main">
						<div id="archiveButton">to Archive</div>
					</div>
					<div id="navBar">
						<div id="activeButton">to Active</div>
					</div>
				</div>
				<div id="archive"></div>
			</div>
		</div>
		<div id="button4" class="navButton">
			<div class="content">
				<div id="active">
					<div id="main">
						<div id="archiveButton">to Archive</div>
					</div>
					<div id="navBar">
						<div id="activeButton">to Active</div>
					</div>
				</div>
				<div id="archive"></div>
			</div>
		</div>
	</div>
	<script type="text/javascript">
		var width,height;

		var staticOrder = [];
		var active = document.getElementById("splash");

		window.onload = function(){
			var root = document.getElementById("almightyParent");
			width = root.offsetWidth;
			height = root.offsetHeight;

			var elements = document.getElementsByClassName("content");
			for(var a = 0; a < elements.length; ++a){
				staticOrder[a] = (new block(elements[a],a, elements.length));
				staticOrder[a].setSize(width,height);
				staticOrder[a].makeColorRandom();
				staticOrder[a].parent.addEventListener("click",makeMain);
			}
		}

		function makeMain(currentEvent){
			var templength = staticOrder.length;
			for(var a = 0; a < templength; ++a){
				if(this == staticOrder[a].parent){
					console.log(staticOrder[a].id);

					//retrive and remove the new active element
					var newActive = staticOrder[a];
					staticOrder.splice(a,1);

					//if there is an active one add it back to the list
					if(active && active.id != "splash"){
						staticOrder.splice(0,0,active);
					}

					//resize the new active element
					newActive.makeBig();
					active = newActive;

					//this resizes all the other elements to their right postion
					for(var b = 0; b < staticOrder.length; ++b){
						staticOrder[b].setOrder(b, staticOrder.length);
					}
					console.log(active.id, [staticOrder[0].id,staticOrder[1].id,staticOrder[2].id])
				}
			}
		}


//This is our class persay
		function block(element, order, totalNumbOfEl){
			this.parent = element.parentNode;
			var parentNode = element.parentNode;
			var content = element;
			var activeMain = findChildId(content,"main");
			var activeContainer = activeMain.parentNode;

			//meta data...
			this.id = this.parent.id;
			var order = order;
			var totalNumbOfEl = totalNumbOfEl;
			this.presenting = false; //to tell if it's big or not
			var localWidth,localHeight;

			//temp to be able to identify it
			//content.innerHTML = (order+1);
			setTimeout(enableTransitions,10);


			this.makeColorRandom = function(){
				content.style.backgroundColor = "#"+(Math.floor(Math.random()*999));
			}

			this.setSize = function(newWidth,newHeight){
				localWidth = newWidth;
				localHeight = newHeight;
				with(this.parent.style){
					left = newWidth - ((order+1)*50);
					zIndex = 2;
				}
				with(content.style){
					width = newWidth*2;
					height = newHeight;
				}
				with(activeContainer.style){
					width = newWidth*1.3; //this makes the left nav for 30%
				}
				with(activeMain.style){
					width = newWidth;
				}
			}

			this.makeBig = function(){
				this.presenting = true;
				with(this.parent.style){
					zIndex = 1;
					left = "0px";
					width = "100%";
				}
			}

			this.setOrder = function(newOrder, newtotalNumbOfEl){
				order = newOrder;
				totalNumbOfEl = newtotalNumbOfEl;
				if(this.presenting){
					with(this.parent.style){
						left = -localWidth;
					}
					disableTransitions();
					this.presenting = false;
					setTimeout(function(){
						console.log(staticOrder);
						for(var b = 0; b < staticOrder.length; ++b){
							staticOrder[b].outEnableTrans();
							staticOrder[b].setOrder(b, staticOrder.length);
						}
					},1000);
				}
				else {
					with(this.parent.style){
						left = localWidth - ((order+1)*50);
						zIndex = 2;
						width = "50px";
					}
				}
			}

			this.function outEnableTrans(){
				enableTransitions();
			}
			function enableTransitions(){
				with(parentNode.style){
					transition = "left 1s, width 1s";
					MozTransition = "left 1s, width 1s";
					WebkitTransition = "left 1s, width 1s";
					OTransition = "left 1s, width 1s";
				}
			}

			function disableTransitions(){
				with(parentNode.style){
					transition = "left 0s, width 0s";
					MozTransition = "left 0s, width 0s";
					WebkitTransition = "left 0s, width 0s";
					OTransition = "left 0s, width 0s";
				}
			}
		}

		function findChildId(within,id){
			var children = within.childNodes;
			for(var a = 0; a < children.length; ++a){
				if(children[a].nodeType == 1){
					if(children[a].id != id){
						var out = findChildId(children[a],id);
						if(out){
							return out;
						}
					} else {
						return children[a]
					}
				}
			}
		}
	</script>
</body>
</html>